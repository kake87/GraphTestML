# GraphTestML
GraphML Test Repository

<h1>Тестовое задание по работе с графовыми БД</h1>
<p>1. Используемая СУБД: neo4j. Управление СУБД осуществляется через библиотеку py2neo</p>
<p>2. Ноутбук создан на базе Jupyter Notebook. Я использовал расширение для vscode. Однако представление этого ноутбука можно вывести и через браузер</p>
<p>3. Данные из csv были скачаны и помещены в локальное хранилище. На этом этапе постановка задачи предполагает несколько решений:</p>
<ol>
<li>скачать файл</li>
<li>обратиться через метод read_csv библиотеки pandas</li>
<li>использовать команду на языке запросов Cypher: LOAD CSV FROM и подобные конструкции.</li>
</ol>
<p>Я выбрал первый путь.</p>

<p>4. Запись данных в БД происходит ниже. Механизм такой: данные были трансформированы в список, который содержит три элемента id, ФИО первого участника, ФИО второго участника.</p>
<p>Необходимо построчно извлечь каждый столбец с данными. Запись можно было бы сделать двумя путями:</p>
<ol>
<li>через экземпляр классов Node, Relationship</li>
<li>С использованием синтаксиса языка запросов Cypher Я выбрал второй вариант, поскольку в задании упор делается на Cypher Конструкция запроса следующая: команда MERGE отвечает за слияние элементов, создаются переменные, p1 и p2, ярлык переменных - Person, переменные включает в себя имена ФИО первого и второго участника</li>
</ol>
<p>Далее происходит установление взаимосвязи (изначально планировалось установить в качестве ярлыка связи id, но это вызывает ошибку)</p>
<p>Последней командой мы передаем наш запрос в базу.</p>

<p>5. Итак, графовое представление создано, мы можем убедится в этом либо перейдя в браузере по адресу: http://localhost:7474/browser/ ![image.png](attachment:image.png) либо делая запросы в ноутбуке</p>
<p>5.1 Далее показана реализация нескольких запросов</p>

![Screenshot](https://imgur.com/a/cD0Dq54)

```MATCH (n:Person) RETURN n.person LIMIT 250```<br>
```MATCH (p:Person) WITH p, size((p)--()) as rel_count WHERE rel_count > 1  RETURN p.name,rel_count LIMIT 10000```

<p>6. Анализируя датасет методом df.count() можно заметить что количество строк равно 5000 При этом около 70 значений в первом списке людей, и 6 значений во втором списке людей являются дубликатами, то есть повторяющимися.</p>
<p>Это означает что одно человек может иметь взаимосвязь с несколькими людьми.</p>
<p>При добавлении в базу визуально и в целом этого не видно, поскольку цепочка человек-человек разбивается попарно, но в то же время согласно условиям задачи необходимо вычленить их.</p>
<p>В целом вычленения одного элемента имеющего несколько связей уже было реализовано на одном из тестовых запросов выше. Однако нам необходимо промаркировать эту выборку.</p>
<p>Для чего был использован инструмент <code>SET</code> и был установлен красный цвет (в отличии от дефолтного зелёного).</p>

![Screenshot](https://imgur.com/a/4iYPeqR)

<p>7. Для проверки результатов в репозитории размещена страница index.html которая принимает аргументы и вносит их в БД. Сервис реализован с помощью библиотеки Flask на Python.</p>
